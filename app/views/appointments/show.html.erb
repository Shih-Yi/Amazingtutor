<!-- <p><button class="click55">open</button></p>
<div class="mask"></div>

<div class="content">
  <div class="contentInside"> -->
<% if current_user == @appointment.user %>
  <% if current_user && @appointment.evaluations.where(evaluatable_type: "User").exists? %>
    <div id="rateYo"></div>
    <div id="content"><%= @raty %></div>
    <%= @appointment.evaluations.where(evaluatable_type: "User").first.comment %>

  <% elsif current_user && @appointment.user == current_user %>
    <div id="rateYo"></div>
    <div id="content"><%= @raty %></div>
    <input type="text" id="comment" value="<%= @evaluationsArray.first.try(:comment) %>">
    <button class="button" >Create</button>
  <% end %>
<% end %>

<% if current_user == @appointment.teacher.user %>
  <% if current_user && @appointment.evaluations.where(evaluatable_type: "Teacher").exists? %>
    <%= @appointment.evaluations.where(evaluatable_type: "Teacher").first.comment %>
  <% elsif current_user && @appointment.teacher == current_user.teacher %>
    <input type="text" id="commentTa" value="<%= @commentTa %>">
    <button class="buttonTa" >Create</button>
  <% end %>
<% end %>
<!--
  <button class="click1">close</button>
  </div>
</div> -->

<script type="text/javascript" charset="utf-8">

$(function () {
  $("#rateYo").rateYo({
    starWidth: "40px",
    numStars: 5,
    fullStar: true,
    rating: <%= @raty %>
  });
});

$(function () {

  var $rateYo = $("#rateYo").rateYo();

  $(".button").click(function () {
    var rating = $rateYo.rateYo("rating");
    var comment = document.getElementById("comment").value;

    var appointment_id =  <%= @appointment.id %>;
    $.ajax({
      type: 'POST',
      url: "/appointments/" + appointment_id + "/evaluations",
      data: {
        type: 0,
        rating: rating,
        comment: comment
      },
      success: function(){
        window.location.assign("http://localhost:3000/");
      },
      error: function() {
        alert("failed");
      }
    });
  });


  $(".buttonTa").click(function () {
    var commentTa = document.getElementById("commentTa").value;

     var appointment_id =  <%= @appointment.id %>;
    $.ajax({
      type: 'POST',
      url: "/appointments/" + appointment_id + "/evaluations",
      data: {
        type: 1,
        commentTa: commentTa
      },
      success: function(){
        window.location.assign("http://localhost:3000/");
      },
      error: function() {
        alert("failed");
      }
    });
  });

});

$(document).ready(function(){
  $('.click55').click(function(){
   $('.mask').css({"display":"block"});
   $('.content').css({"display":"block"});
  });
  $('.click1').click(function(){
   $('.mask').css({"display":"none"});
   $('.content').css({"display":"none"});
  });
});

</script>

